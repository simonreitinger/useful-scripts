#
# bash script for creating a virtual host in apache
#

# domain
echo "Type in the domain of the new virtual host: "
read domain
while [[ -z $domain ]]
do
	echo "Type in the domain of the new virtual host: "
	read domain
done

# DocumentRoot and Directory
echo "Enter the DocumentRoot of the server (e. g. /Users/$LOGNAME/www/):"
read document_root
while [[ -z $document_root ]]
do
	echo "Enter the DocumentRoot of the server (e. g. /Users/$LOGNAME/www/):"
	read document_root
done

echo "Enter the port for the virtual host: (default: 80)"
read vhost_port
if [[ !$vhost_port ]]
then
	vhost_port="80"
fi


# Email
echo "Enter the ServerAdmin Email address: ($LOGNAME@localhost)"
read email
if [[ !$email ]]
then
	email="$LOGNAME@localhost"
fi

# options
echo "Enter the Options for the virtual host: (Indexes FollowSymlinks MultiViews)"
read $options
if [[ !$options ]]
then
	options="Indexes FollowSymlinks MultiViews"
fi

# allow override
echo "Enter the AllowOverride value: (default: All)"
read allow_override
if [[ !$allow_override ]]
then
	allow_override="All"
fi

# order
echo "Enter the Order value: (default: allow,deny)"
read order
if [[ !$order ]]
then
	order="All"
fi

# permission
echo "Enter the Permissions: (default: allow from all)"
read permissions
if [[ !$permissions ]]
then
	permissions="allow from all"
fi

echo "Enter the location for the vhost file"
echo "(default: /usr/local/etc/httpd/extra/httpd-vhosts.conf)"
echo
read vhost_file
if [[ !$vhost_file ]]
then
	vhost_file="/usr/local/etc/httpd/extra/httpd-vhosts.conf"
fi


echo "The following vhost will be added to $vhost_file"
echo
echo "<VirtualHost *:$vhost_post>"
echo "    ServerName $domain"
echo "    ServerAlias $domain"
echo "    ServerAdmin $email"
echo "    DocumentRoot $document_root"
echo "    <Directory $document_root>"
echo "        Options $options"
echo "        AllowOverride $allow_override"
echo "        Order $order"
echo "        $permissions"
echo "    </Directory>"
echo "    ErrorLog \"logs/$domain-error_log\""
echo "    CustomLog \"logs/$domain-access_log\" common"
echo "</VirtualHost>"

echo
echo "do you want to add this output to $vhost_file (y / n)?"
read answer
if [[ $answer = "y" ]]
then
    echo "" >> $vhost_file
    echo "<VirtualHost *:$vhost_port>" >> $vhost_file
    echo "    ServerName $domain" >> $vhost_file
    echo "    ServerAlias $domain" >> $vhost_file
    echo "    ServerAdmin $emailt" >> $vhost_file
    echo "    DocumentRoot $document_root" >> $vhost_file
    echo "    <Directory $document_root>" >> $vhost_file
    echo "        Options $options" >> $vhost_file
    echo "        AllowOverride $allow_override" >> $vhost_file
    echo "        Order $order" >> $vhost_file
    echo "        $permissions" >> $vhost_file
    echo "    </Directory>" >> $vhost_file
    echo "    ErrorLog \"logs/$domain-error_log\"" >> $vhost_file
    echo "    CustomLog \"logs/$domain-access_log\" common" >> $vhost_file
    echo "</VirtualHost>" >> $vhost_file
fi

echo
cat $vhost_file

echo "do you want to edit $vhost_file?"
read answer
if [ "$answer" = "y" ]
then    
    open -e $vhost_file
fi

echo
echo "done!"